#pragma once

////////////////////////////////////////////////////////////////////////////////////////////////////

#include <libutl/NetServer.h>

////////////////////////////////////////////////////////////////////////////////////////////////////

UTL_NS_BEGIN;

////////////////////////////////////////////////////////////////////////////////////////////////////

class NetServerClient;

////////////////////////////////////////////////////////////////////////////////////////////////////

/**
   Abstract base for networked server that accepts commands represented as Array objects.

   \author Adam McKee
   \ingroup communication
*/

////////////////////////////////////////////////////////////////////////////////////////////////////

class NetCmdServer : public NetServer
{
    UTL_CLASS_DECL_ABC(NetCmdServer, NetServer);
    UTL_CLASS_DEFID;

public:
    NetCmdServer(size_t maxClients, size_t maxPaused, size_t clientsPerThread = 1)
        : NetServer(maxClients, maxPaused, clientsPerThread)
    {
    }

private:
    virtual void clientReadMsg(NetServerClient* client);
    virtual void handleCmd(NetServerClient* client, const Array& cmd) = 0;
};

////////////////////////////////////////////////////////////////////////////////////////////////////

UTL_NS_END;
