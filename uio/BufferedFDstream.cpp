#include <libutl/libutl.h>
#include <libutl/BufferedFDstream.h>

////////////////////////////////////////////////////////////////////////////////////////////////////

UTL_CLASS_IMPL(utl::BufferedFDstream);

////////////////////////////////////////////////////////////////////////////////////////////////////

UTL_NS_BEGIN;

////////////////////////////////////////////////////////////////////////////////////////////////////

#if UTL_HOST_TYPE == UTL_HT_UNIX
bool
BufferedFDstream::blockRead(uint32_t usec)
{
    // data is available for reading (from buffer)
    if (_iBufPos != _iBufLim)
        return true;

    // wait the given amount of time for data to appear
    return pget()->blockRead(usec);
}
#endif

////////////////////////////////////////////////////////////////////////////////////////////////////

BufferedFDstream cin(0, io_rd);
BufferedFDstream cout(1, io_wr);
BufferedFDstream cerr(2, io_wr);

////////////////////////////////////////////////////////////////////////////////////////////////////

UTL_NS_END;
